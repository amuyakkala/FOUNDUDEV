const { getAuthConfig, saveToConfig } = require('./config');

// Read auth token from config file
function getAuthToken() {
  const config = getAuthConfig();
  return config.TOOLHOUSE_AUTH_TOKEN || null;
}

// Read API key from config file
function getApiKey() {
  const config = getAuthConfig();
  return config.TOOLHOUSE_API_KEY || null;
}

// Write auth token to config file
function saveAuthToken(token) {
  saveToConfig({ TOOLHOUSE_AUTH_TOKEN: token });
}

// Write API key to config file
function saveApiKey(apiKey) {
  saveToConfig({ TOOLHOUSE_API_KEY: apiKey });
}

// Check if user is authenticated
function isAuthenticated() {
  const token = getAuthToken();
  const apiKey = getApiKey();
  return !!token && !!apiKey;
}

module.exports = {
  getAuthToken,
  getApiKey,
  saveAuthToken,
  saveApiKey,
  isAuthenticated
};